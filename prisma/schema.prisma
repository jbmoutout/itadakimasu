datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  directUrl         = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Recipe {
  id          Int                @id @default(autoincrement())
  url         String
  originUrl   String?
  title       String?
  description String?
  image       String?
  createdAt   DateTime           @default(now())
  userId      Int?
  ingredients RecipeIngredient[]
  ratings     Rating[]
}

model ShoppingList {
  id        Int      @id @default(autoincrement())
  data      Json
  checked   Boolean @default(false)
  createdAt DateTime @default(now())
  userId    Int?
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ratings  Rating[]

}

model Ingredient {
  id          Int                 @id @default(autoincrement())
  name        String              @unique
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt
  recipes     RecipeIngredient[]
}

model RecipeIngredient {
  id           Int        @id @default(autoincrement())
  recipeId     Int
  ingredientId Int
  quantity     Float?
  unit         String?
  recipe       Recipe     @relation(fields: [recipeId], references: [id])
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  @@unique([recipeId, ingredientId])
}

model Rating {
  id        Int          @id @default(autoincrement())
  recipeId  Int
  userId    Int
  value     RatingValue  @default(NONE)
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt

  recipe Recipe @relation(fields: [recipeId], references: [id])
  user   User   @relation(fields: [userId], references: [id])

  @@unique([recipeId, userId])
}

enum RatingValue {
  NONE
  ONE
  TWO
  THREE
  FOUR
  FIVE
}